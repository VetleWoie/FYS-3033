\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[margin=2cm]{geometry}
\usepackage{graphicx}
% \usepackage[numbers]{natbib}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
% \usepackage{hyperref}
\usepackage{listings}
% \usepackage{xcolor}

\title{FYS-3033 Exam}
\author{Canditate}
\date{2022}
 
\begin{document}

\maketitle
\section{Assignment 1}
\subsection*{a)}
Cross entropy is a measurment of how diffrent two probability distributions are.
\begin{equation}
    \begin{split}
        H(z,y) &= -\sum_{i=0}^1 E_{yi}\log(z_i)\\
        &= -\left(1\cdot\log(z_0)+0\cdot\log(z_1)\right)\\
        &= -\log(z_0)\\    
    \end{split}
\end{equation}

\subsection*{b)}
If $z$ are not stochastic then we cannot guarantee that the cross entropy function is defined. Any values of $z <= 0$ will not be defined by the cross entropy function. Even if we limit $z > 0$, the derivative of the cross entropy function approaches $0$ when $z$ gets large, which will inhibit learning.

\subsection*{c)}
\subsection*{d)}

Without regularization:
\begin{equation}
    \begin{split} 
        \textit{Need to find where derivative equalls 0}\\
        \frac{d}{dz}\left[-y\log(z)+(1-y)\log(1-z)\right] &= 0\\
        \frac{-y}{z}+\frac{1-y}{1-z} &= 0\\
        \frac{-y}{z} &= -\left(\frac{1-y}{1-z}\right)\\
        \frac{1-z}{z} &= \frac{1-y}{y}\\
        z&=y\\
        argmin_\mathbf{z} CE(\mathbf{z}; \mathbf{y})&=z\\
    \end{split}
\end{equation}
For 

With $\ell^2$-regularization
\begin{equation}
    \begin{split}
        \frac{d}{dz}\left[-y\log(z)+(1-y)\log(1-z)+||z||_2^2\right] &= 0\\
        \frac{-y}{z}+\frac{1-y}{1-z}+2z &= 0\\
        -2z^3+2z^2+z+y &=0\\
        y=0:\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad&\\
        -2z^3+2z^2+z &=0\\
        z(-2z^2+2z+1) &= 0\\
        z = \frac{1-\sqrt{3}}{2} \vee z &= 0 \vee z = \frac{1+\sqrt{3}}{2}\\  
        z\in\left(0,1\right)\\
        y=1:\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad&\\
        -2z^3+2z^2+z+1 &=0\\
        z = -\frac{\sqrt{2}}{2} \vee z &= 1 \vee z = \frac{\sqrt{2}}{2}\\ 
        argmin_\mathbf{z} CE(\mathbf{z}; \mathbf{y}) + ||\mathbf{z}||^2_2 = \left[0,\frac{\sqrt{2}}{2}\right]\\
    \end{split}
\end{equation}

With $\ell^1$-regularization
\begin{equation}
    \begin{split}
        argmin_\mathbf{z} CE(\mathbf{z}; \mathbf{y}) + ||\mathbf{z}||_1 &= 0 + \sum_i |w_i|\\
                                                                        &= z_0 + z_1\\
                                                                        &= 1\\
    \end{split}
\end{equation}

\subsection*{e)}

\section{Assignment 2}
\section{Assignment 3}

\section{Appendix} 
% \lstinputlisting[language=Python]{./layers.py}    
\end{document}
